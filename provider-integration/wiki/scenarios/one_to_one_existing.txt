# https://sequencediagram.org/

autoactivation
actor "UCloud User\nAlice#1234" as User

participantgroup #lightgreen ** UCloud\nNetwork**
participant "UCloud" as UCloud
database "UCloud DB" as UCloudDB
end

participantgroup #lightblue **Provider\nNetwork**
participantgroup #lightyellow **New components**
participant "Integration Module" as Provider
database "Integration DB" as UserDB
end
participantgroup #pink **Existing components**

participant "                                 HPC                                 " as HPC
end

end

User->UCloud: Connect with provider
UCloud->Provider: Alice#1234 wishes to connect
Provider-->UCloud: Instructions on how to authenticate/request a user
UCloud-->User: Forward instructions


ref over User, HPC: Establish connection according to instructions


HPC->Provider: Alice#1234 (UCloud) \nhas connected as \nalice@idp.example.com (Provider)
Provider->UserDB: Insert mapping between: \nAlice#1234 and alice@idp.example.com
UserDB-->Provider: OK

Provider->UCloud: Mapping for Alice#1234 complete
UCloud->UCloudDB: Mark mapping as complete
UCloudDB-->UCloud: OK
UCloud-->Provider: OK
Provider-->HPC: OK
HPC-->User: Connection complete


== Alice#1234 can now consume resources from the provider ==
